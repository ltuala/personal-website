"use strict";(self.webpackChunkdocusaurus_try_website=self.webpackChunkdocusaurus_try_website||[]).push([[5606],{3905:(e,t,a)=>{a.d(t,{Zo:()=>s,kt:()=>h});var o=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,o,n=function(e,t){if(null==e)return{};var a,o,n={},i=Object.keys(e);for(o=0;o<i.length;o++)a=i[o],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)a=i[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var p=o.createContext({}),c=function(e){var t=o.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},s=function(e){var t=c(e.components);return o.createElement(p.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,p=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),d=c(a),m=n,h=d["".concat(p,".").concat(m)]||d[m]||u[m]||i;return a?o.createElement(h,r(r({ref:t},s),{},{components:a})):o.createElement(h,r({ref:t},s))}));function h(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,r=new Array(i);r[0]=m;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[d]="string"==typeof e?e:n,r[1]=l;for(var c=2;c<i;c++)r[c]=a[c];return o.createElement.apply(null,r)}return o.createElement.apply(null,a)}m.displayName="MDXCreateElement"},2714:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>r,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>c});var o=a(7462),n=(a(7294),a(3905));const i={slug:"dockerized-a-timefold-app",title:"How to Dockerized a Timefold Application",authors:["ltuala"],tags:["docker","timefold","postgresql"],enableComments:!0},r=void 0,l={permalink:"/personal-website/dockerized-a-timefold-app",source:"@site/blog/2024-03-08-dockerized-a-timefold-app/index.mdx",title:"How to Dockerized a Timefold Application",description:"Timefold examples are available with a Dockerfile already for you to start with. In this blog, I tried to explore how to deploy the Timefold application via docker.",date:"2024-03-08T00:00:00.000Z",formattedDate:"March 8, 2024",tags:[{label:"docker",permalink:"/personal-website/tags/docker"},{label:"timefold",permalink:"/personal-website/tags/timefold"},{label:"postgresql",permalink:"/personal-website/tags/postgresql"}],readingTime:1.725,hasTruncateMarker:!0,authors:[{name:"Lyndon Tuala",title:"Newbie",url:"https://github.com/ltuala",imageURL:"https://github.com/ltuala.png",key:"ltuala"}],frontMatter:{slug:"dockerized-a-timefold-app",title:"How to Dockerized a Timefold Application",authors:["ltuala"],tags:["docker","timefold","postgresql"],enableComments:!0},nextItem:{title:"How to Add Search Bar in Docusaurus",permalink:"/personal-website/add-search-bar"}},p={authorsImageUrls:[void 0]},c=[{value:"Here&#39;s a step-by-step guide on how I deploy the Timefold application via docker:",id:"heres-a-step-by-step-guide-on-how-i-deploy-the-timefold-application-via-docker",level:2},{value:"1. Package the Application",id:"1-package-the-application",level:3},{value:"2. Build the Image",id:"2-build-the-image",level:3},{value:"3. Modify <code>application.properties</code>",id:"3-modify-applicationproperties",level:3},{value:"4. Run the application",id:"4-run-the-application",level:3},{value:"5. Test the Application",id:"5-test-the-application",level:3}],s={toc:c},d="wrapper";function u(e){let{components:t,...i}=e;return(0,n.kt)(d,(0,o.Z)({},s,i,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"Timefold examples are available with a Dockerfile already for you to start with. In this blog, I tried to explore how to deploy the Timefold application via docker."),(0,n.kt)("admonition",{title:"Prerequisites",type:"caution"},(0,n.kt)("p",{parentName:"admonition"},(0,n.kt)("strong",{parentName:"p"},"Timefold")," requires a Java version ",(0,n.kt)("strong",{parentName:"p"},"17+"),". See ",(0,n.kt)("a",{parentName:"p",href:"https://docs.oracle.com/en/java/javase/20/install/installation-jdk-microsoft-windows-platforms.html"},"JDK on Windows"),", for official documentation on how to install JDK.")),(0,n.kt)("h2",{id:"heres-a-step-by-step-guide-on-how-i-deploy-the-timefold-application-via-docker"},"Here's a step-by-step guide on how I deploy the Timefold application via docker:"),(0,n.kt)("admonition",{title:"High-level Overview",type:"note"},(0,n.kt)("p",{parentName:"admonition"},(0,n.kt)("img",{alt:"High-level",src:a(3215).Z,width:"481",height:"311"}))),(0,n.kt)("p",null,"Here I just deploy the Timefold application via docker and use a local database as the data source."),(0,n.kt)("h3",{id:"1-package-the-application"},"1. Package the Application"),(0,n.kt)("p",null,"Before building the container image, package the application first. Run the command:  "),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"mvn clean install \n")),(0,n.kt)("h3",{id:"2-build-the-image"},"2. Build the Image"),(0,n.kt)("p",null,"To build the image use the Dockerfile readily available. "),(0,n.kt)("admonition",{title:"Dockerfile code",type:"note"},(0,n.kt)("pre",{parentName:"admonition"},(0,n.kt)("code",{parentName:"pre"},'FROM registry.access.redhat.com/ubi8/openjdk-17:1.15\n\nENV LANGUAGE=\'en_US:en\'\n\n\n# We make four distinct layers so if there are application changes the library layers can be re-used\nCOPY --chown=185 target/quarkus-app/lib/ /deployments/lib/\nCOPY --chown=185 target/quarkus-app/*.jar /deployments/\nCOPY --chown=185 target/quarkus-app/app/ /deployments/app/\nCOPY --chown=185 target/quarkus-app/quarkus/ /deployments/quarkus/\n\n# Add the extra host entry to the container\'s /etc/hosts file\n# RUN echo "host.docker.internal    host-gateway" >> /etc/hosts\n\nEXPOSE 8080\nUSER 185\nENV JAVA_OPTS="-Dquarkus.http.host=0.0.0.0 -Djava.util.logging.manager=org.jboss.logmanager.LogManager"\nENV JAVA_APP_JAR="/deployments/quarkus-run.jar"\n'))),(0,n.kt)("p",null,"Then, run a ",(0,n.kt)("inlineCode",{parentName:"p"},"docker build")," command:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"docker build -f src/main/docker/Dockerfile.jvm -t quarkus/campaign-scheduling .\n")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"quarkus/campaign-scheduling")," is the image name")),(0,n.kt)("p",null,"If you have a docker desktop available the image should look like this:\n",(0,n.kt)("img",{alt:"Docker image",src:a(5973).Z,width:"1193",height:"90"})),(0,n.kt)("h3",{id:"3-modify-applicationproperties"},"3. Modify ",(0,n.kt)("inlineCode",{parentName:"h3"},"application.properties")),(0,n.kt)("p",null,"To be able to connect to the local database make sure to update the ",(0,n.kt)("inlineCode",{parentName:"p"},"quarkus.datasource.jdbc.url"),", set it to ",(0,n.kt)("inlineCode",{parentName:"p"},"host.docker.internal")," instead of ",(0,n.kt)("inlineCode",{parentName:"p"},"localhost"),".\nThis tells docker to connect to a custom network made available by docker and this particular custom network allows you to connect to your local ",(0,n.kt)("inlineCode",{parentName:"p"},"localhost"),".\n",(0,n.kt)("img",{alt:"Network",src:a(4151).Z,width:"968",height:"189"})),(0,n.kt)("h3",{id:"4-run-the-application"},"4. Run the application"),(0,n.kt)("p",null,"To run the aplicaion, run ",(0,n.kt)("inlineCode",{parentName:"p"},"docker run")," command:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"docker run -i --rm -p 8080:8080 --add-host=host.docker.internal:host-gateway quarkus/campaign-scheduling\n")),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Docker run",src:a(8713).Z,width:"1520",height:"292"})),(0,n.kt)("h3",{id:"5-test-the-application"},"5. Test the Application"),(0,n.kt)("p",null,"Connect to the application via your local browser.\n",(0,n.kt)("img",{alt:"Test application",src:a(1859).Z,width:"1884",height:"831"})),(0,n.kt)("admonition",{title:"Congratulations!",type:"note"},(0,n.kt)("p",{parentName:"admonition"},"You have now successfully deployed a Timefold application via docker and allow it to connect to a local database.")))}u.isMDXComponent=!0},4151:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/application-properties-2c57a28690b66c899b218f658bd55391.png"},8713:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/docker-run-cfa524ab4dc3c747d8fd2a6be74f7cf3.png"},3215:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/dockerrized-high-level-2d26f8cb31c331fc7f3fdff32b6e4ebe.png"},5973:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/image-name-2c6bca0082d110aa127203f6778541de.png"},1859:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/test-application-1d82442fb3f5782e8b473d1bf640d7a5.png"}}]);