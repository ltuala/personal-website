"use strict";(self.webpackChunkdocusaurus_try_website=self.webpackChunkdocusaurus_try_website||[]).push([[4344],{1716:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>r,contentTitle:()=>s,default:()=>p,frontMatter:()=>l,metadata:()=>i,toc:()=>c});var i=a(7827),o=a(4848),n=a(8453);const l={slug:"dockerized-a-timefold-app",title:"How to Dockerized a Timefold Application",authors:["ltuala"],tags:["docker","timefold","postgresql"],enableComments:!0},s=void 0,r={authorsImageUrls:[void 0]},c=[{value:"Here&#39;s a step-by-step guide on how I deploy the Timefold application via docker:",id:"heres-a-step-by-step-guide-on-how-i-deploy-the-timefold-application-via-docker",level:2},{value:"1. Package the Application",id:"1-package-the-application",level:3},{value:"2. Build the Image",id:"2-build-the-image",level:3},{value:"3. Modify <code>application.properties</code>",id:"3-modify-applicationproperties",level:3},{value:"4. Run the application",id:"4-run-the-application",level:3},{value:"5. Test the Application",id:"5-test-the-application",level:3}];function d(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.p,{children:"Timefold examples are available with a Dockerfile already for you to start with. In this blog, I tried to explore how to deploy the Timefold application via docker."}),"\n",(0,o.jsx)(t.admonition,{title:"Prerequisites",type:"caution",children:(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Timefold"})," requires a Java version ",(0,o.jsx)(t.strong,{children:"17+"}),". See ",(0,o.jsx)(t.a,{href:"https://docs.oracle.com/en/java/javase/20/install/installation-jdk-microsoft-windows-platforms.html",children:"JDK on Windows"}),", for official documentation on how to install JDK."]})}),"\n",(0,o.jsx)(t.h2,{id:"heres-a-step-by-step-guide-on-how-i-deploy-the-timefold-application-via-docker",children:"Here's a step-by-step guide on how I deploy the Timefold application via docker:"}),"\n",(0,o.jsx)(t.admonition,{title:"High-level Overview",type:"note",children:(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"High-level",src:a(5080).A+"",width:"481",height:"311"})})}),"\n",(0,o.jsx)(t.p,{children:"Here I just deploy the Timefold application via docker and use a local database as the data source."}),"\n",(0,o.jsx)(t.h3,{id:"1-package-the-application",children:"1. Package the Application"}),"\n",(0,o.jsx)(t.p,{children:"Before building the container image, package the application first. Run the command:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"mvn clean install \n"})}),"\n",(0,o.jsx)(t.h3,{id:"2-build-the-image",children:"2. Build the Image"}),"\n",(0,o.jsx)(t.p,{children:"To build the image use the Dockerfile readily available."}),"\n",(0,o.jsx)(t.admonition,{title:"Dockerfile code",type:"note",children:(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:'FROM registry.access.redhat.com/ubi8/openjdk-17:1.15\n\nENV LANGUAGE=\'en_US:en\'\n\n\n# We make four distinct layers so if there are application changes the library layers can be re-used\nCOPY --chown=185 target/quarkus-app/lib/ /deployments/lib/\nCOPY --chown=185 target/quarkus-app/*.jar /deployments/\nCOPY --chown=185 target/quarkus-app/app/ /deployments/app/\nCOPY --chown=185 target/quarkus-app/quarkus/ /deployments/quarkus/\n\n# Add the extra host entry to the container\'s /etc/hosts file\n# RUN echo "host.docker.internal    host-gateway" >> /etc/hosts\n\nEXPOSE 8080\nUSER 185\nENV JAVA_OPTS="-Dquarkus.http.host=0.0.0.0 -Djava.util.logging.manager=org.jboss.logmanager.LogManager"\nENV JAVA_APP_JAR="/deployments/quarkus-run.jar"\n'})})}),"\n",(0,o.jsxs)(t.p,{children:["Then, run a ",(0,o.jsx)(t.code,{children:"docker build"})," command:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"docker build -f src/main/docker/Dockerfile.jvm -t quarkus/campaign-scheduling .\n"})}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.code,{children:"quarkus/campaign-scheduling"})," is the image name"]}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["If you have a docker desktop available the image should look like this:\n",(0,o.jsx)(t.img,{alt:"Docker image",src:a(5813).A+"",width:"1193",height:"90"})]}),"\n",(0,o.jsxs)(t.h3,{id:"3-modify-applicationproperties",children:["3. Modify ",(0,o.jsx)(t.code,{children:"application.properties"})]}),"\n",(0,o.jsxs)(t.p,{children:["To be able to connect to the local database make sure to update the ",(0,o.jsx)(t.code,{children:"quarkus.datasource.jdbc.url"}),", set it to ",(0,o.jsx)(t.code,{children:"host.docker.internal"})," instead of ",(0,o.jsx)(t.code,{children:"localhost"}),".\nThis tells docker to connect to a custom network made available by docker and this particular custom network allows you to connect to your local ",(0,o.jsx)(t.code,{children:"localhost"}),".\n",(0,o.jsx)(t.img,{alt:"Network",src:a(9696).A+"",width:"968",height:"189"})]}),"\n",(0,o.jsx)(t.h3,{id:"4-run-the-application",children:"4. Run the application"}),"\n",(0,o.jsxs)(t.p,{children:["To run the aplicaion, run ",(0,o.jsx)(t.code,{children:"docker run"})," command:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"docker run -i --rm -p 8080:8080 --add-host=host.docker.internal:host-gateway quarkus/campaign-scheduling\n"})}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Docker run",src:a(7032).A+"",width:"1520",height:"292"})}),"\n",(0,o.jsx)(t.h3,{id:"5-test-the-application",children:"5. Test the Application"}),"\n",(0,o.jsxs)(t.p,{children:["Connect to the application via your local browser.\n",(0,o.jsx)(t.img,{alt:"Test application",src:a(8053).A+"",width:"1884",height:"831"})]}),"\n",(0,o.jsx)(t.admonition,{title:"Congratulations!",type:"note",children:(0,o.jsx)(t.p,{children:"You have now successfully deployed a Timefold application via docker and allow it to connect to a local database."})})]})}function p(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},5080:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/dockerrized-high-level-2d26f8cb31c331fc7f3fdff32b6e4ebe.png"},5813:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/image-name-2c6bca0082d110aa127203f6778541de.png"},7032:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/docker-run-cfa524ab4dc3c747d8fd2a6be74f7cf3.png"},7827:e=>{e.exports=JSON.parse('{"permalink":"/personal-website/blog/dockerized-a-timefold-app","source":"@site/blog/2024-03-08-dockerized-a-timefold-app/index.mdx","title":"How to Dockerized a Timefold Application","description":"Timefold examples are available with a Dockerfile already for you to start with. In this blog, I tried to explore how to deploy the Timefold application via docker.","date":"2024-03-08T00:00:00.000Z","tags":[{"inline":true,"label":"docker","permalink":"/personal-website/blog/tags/docker"},{"inline":true,"label":"timefold","permalink":"/personal-website/blog/tags/timefold"},{"inline":true,"label":"postgresql","permalink":"/personal-website/blog/tags/postgresql"}],"readingTime":1.725,"hasTruncateMarker":true,"authors":[{"name":"Lyndon Tuala","title":"Newbie","url":"https://github.com/ltuala","imageURL":"https://github.com/ltuala.png","key":"ltuala","page":null}],"frontMatter":{"slug":"dockerized-a-timefold-app","title":"How to Dockerized a Timefold Application","authors":["ltuala"],"tags":["docker","timefold","postgresql"],"enableComments":true},"unlisted":false,"prevItem":{"title":"Ardit Sulce\'s \\"Python Mega Course Learn Python in 60 Days, Build 20 Apps\\"","permalink":"/personal-website/blog/60-days-of-python"},"nextItem":{"title":"How to Add Search Bar in Docusaurus","permalink":"/personal-website/blog/add-search-bar"}}')},8053:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/test-application-1d82442fb3f5782e8b473d1bf640d7a5.png"},8453:(e,t,a)=>{a.d(t,{R:()=>l,x:()=>s});var i=a(6540);const o={},n=i.createContext(o);function l(e){const t=i.useContext(n);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),i.createElement(n.Provider,{value:t},e.children)}},9696:(e,t,a)=>{a.d(t,{A:()=>i});const i=a.p+"assets/images/application-properties-2c57a28690b66c899b218f658bd55391.png"}}]);